# 手动开票服务项目需求文档

## 项目背景
为新西兰用户开发一款手动开票服务，旨在简化用户开具发票的流程。用户只需输入发票明细，程序将智能计算总金额、适用税率，并自动生成一份包含完整信息的PDF发票文件，同时返回文件路径，方便用户下载或直接查看。

## 功能需求

### 1. 用户输入
- 用户可以通过界面输入以下发票明细：
  - 商品或服务名称
  - 数量
  - 单价
  - 税率（可选，若未输入则使用默认税率）
  - 其他备注信息（可选）

### 2. 智能计算
- 程序根据用户输入的明细自动计算：
  - 每项商品或服务的总金额（数量 × 单价）
  - 发票总金额（所有项目金额之和）
  - 适用税率和税额（若用户未输入税率，则使用新西兰默认税率）

### 3. PDF 发票生成
- 程序生成一份包含以下信息的PDF发票：
  - 发票编号（自动生成）
  - 开票日期（自动生成）
  - 用户输入的所有明细
  - 每项商品或服务的总金额
  - 发票总金额
  - 税率和税额
  - 备注信息（若有）
- PDF 文件格式美观，符合标准发票样式。

### 4. 文件路径返回
- 程序生成PDF文件后，返回文件的完整路径，方便用户下载或直接查看。

## 技术需求
- **编程语言**：Python
- **框架和库**：
  - PDF 生成：`reportlab` 或 `fpdf`
  - 数据验证：`pydantic`
- **运行环境**：支持本地运行和云端部署
- **文件存储**：本地文件系统，支持后续扩展为云存储

## 非功能需求
- **易用性**：界面简洁直观，用户无需复杂操作即可完成开票。
- **性能**：生成PDF文件的时间不超过2秒。
- **扩展性**：支持未来添加更多功能，如多语言支持、发票模板自定义等。

## 测试需求
- 单元测试覆盖率不低于80%。
- 测试场景包括但不限于：
  - 正常输入的发票生成
  - 边界条件（如空输入、极大或极小的数值）
  - 异常处理（如非法输入）

## 项目交付
- 源代码
- 使用说明文档
- 示例输入和生成的PDF文件

## 时间计划
- 项目开发周期：4周
- 里程碑：
  1. 第1周：需求分析与技术选型
  2. 第2周：核心功能开发（用户输入与智能计算）
  3. 第3周：PDF生成与文件路径返回
  4. 第4周：测试与优化

## 备注
- 默认税率按照新西兰现行标准税率（15%）计算。